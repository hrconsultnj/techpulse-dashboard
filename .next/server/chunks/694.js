exports.id=694,exports.ids=[694],exports.modules={1100:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6346,23)),Promise.resolve().then(t.t.bind(t,7924,23)),Promise.resolve().then(t.t.bind(t,5656,23)),Promise.resolve().then(t.t.bind(t,99,23)),Promise.resolve().then(t.t.bind(t,8243,23)),Promise.resolve().then(t.t.bind(t,8827,23)),Promise.resolve().then(t.t.bind(t,2763,23)),Promise.resolve().then(t.t.bind(t,7173,23))},4252:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6444,23)),Promise.resolve().then(t.t.bind(t,6042,23)),Promise.resolve().then(t.t.bind(t,8170,23)),Promise.resolve().then(t.t.bind(t,9477,23)),Promise.resolve().then(t.t.bind(t,9345,23)),Promise.resolve().then(t.t.bind(t,2089,23)),Promise.resolve().then(t.t.bind(t,6577,23)),Promise.resolve().then(t.t.bind(t,1307,23))},4263:()=>{},4431:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/helderrodrigues/Projects/techpulse-dashboard/src/app/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/helderrodrigues/Projects/techpulse-dashboard/src/app/layout.tsx","default")},6311:(e,r,t)=>{Promise.resolve().then(t.bind(t,8896))},6479:(e,r,t)=>{Promise.resolve().then(t.bind(t,4431))},7990:()=>{},8248:(e,r,t)=>{"use strict";t.d(r,{A:()=>d});var s=t(3210),a=t(463);let l="https://fcqejcrxtrqdxybgyueu.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZjcWVqY3J4dHJxZHh5Ymd5dWV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM5NjE5NDgsImV4cCI6MjA1OTUzNzk0OH0.4_0zjIvreUrDE-wFNoHY62aMw9w-spf0mEdPyarxerM";if(!l||!o)throw Error("Missing Supabase environment variables. Check your .env.local file.");let n=(0,a.UU)(l,o),i={async getAll(e,r={}){let t=n.from(e).select(r.columns||"*");r.filters&&r.filters.forEach(e=>{t=t.filter(e.column,e.operator,e.value)}),r.order&&(t=t.order(r.order.column,{ascending:r.order.ascending})),r.limit&&(t=t.limit(r.limit)),r.offset&&(t=t.range(r.offset,r.offset+(r.limit||10)-1));let{data:s,error:a}=await t;if(a)throw console.error(`Error fetching from ${e}:`,a),a;return s||[]},async getById(e,r,t){let{data:s,error:a}=await n.from(e).select(t||"*").eq("id",r).single();if(a){if("PGRST116"===a.code)return null;throw console.error(`Error fetching ${e} by ID:`,a),a}return s},async create(e,r){let{data:t,error:s}=await n.from(e).insert([r]).select().single();if(s)throw console.error(`Error creating ${e}:`,s),s;return t},async update(e,r,t){let{data:s,error:a}=await n.from(e).update(t).eq("id",r).select().single();if(a)throw console.error(`Error updating ${e}:`,a),a;return s},async delete(e,r){let{error:t}=await n.from(e).delete().eq("id",r);if(t)throw console.error(`Error deleting from ${e}:`,t),t},async search(e,r,t=["*"],s=10){let a=t.filter(e=>"*"!==e).map(e=>`${e}.ilike.%${r}%`).join(","),l=n.from(e).select("*").or(a).limit(s),{data:o,error:i}=await l;if(i)throw console.error(`Error searching ${e}:`,i),i;return o||[]}};class c{async sendWebhook(e){let r=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error(`Webhook failed: ${r.status} ${r.statusText}`);return r.json()}async triggerUserSignup(e){let r={type:"user_signup",data:e,timestamp:new Date().toISOString(),source:"techpulse-dashboard"};try{await this.sendWebhook(r),console.log("User signup webhook triggered successfully")}catch(e){throw console.error("Failed to trigger user signup webhook:",e),e}}async triggerMarketingEmail(e){let r={type:"marketing_email",data:e,timestamp:new Date().toISOString(),source:"techpulse-dashboard"};try{await this.sendWebhook(r),console.log("Marketing email webhook triggered successfully")}catch(e){throw console.error("Failed to trigger marketing email webhook:",e),e}}async triggerCRMContact(e){let r={type:"crm_contact",data:e,timestamp:new Date().toISOString(),source:"techpulse-dashboard"};try{await this.sendWebhook(r),console.log("CRM contact webhook triggered successfully")}catch(e){throw console.error("Failed to trigger CRM contact webhook:",e),e}}constructor(){this.baseUrl="/api/webhook-proxy"}}let u=new c;function d(){let[e,r]=(0,s.useState)({user:null,profile:null,loading:!0,error:null}),t=(0,s.useCallback)(e=>{r(r=>({...r,error:e,loading:!1}))},[]),a=(0,s.useCallback)(e=>{r(r=>({...r,loading:e}))},[]);(0,s.useCallback)(async e=>{try{return await i.getById("user_profiles",e)}catch(e){return console.error("Error fetching user profile:",e),null}},[]);let l=(0,s.useCallback)(async e=>{try{a(!0),t(null);let{error:r}=await n.auth.signInWithPassword(e);if(r)throw r;return{error:null}}catch(r){let e=r instanceof Error?r.message:"Sign in failed";return t(e),{error:e}}},[t,a]),o=(0,s.useCallback)(async e=>{try{a(!0),t(null);let{email:r,password:s,...l}=e,{data:o,error:i}=await n.auth.signUp({email:r,password:s,options:{data:l}});if(i)throw i;if(o.user)try{await Promise.all([u.triggerUserSignup({userId:o.user.id,email:r,fullName:l.full_name,role:l.role||"customer",companyName:l.company_name,phone:l.phone,metadata:{signupDate:new Date().toISOString(),userAgent:navigator.userAgent,referrer:document.referrer}}),u.triggerMarketingEmail({email:r,fullName:l.full_name,tags:["new_user",l.role||"customer"],customFields:{companyName:l.company_name,phone:l.phone,signupDate:new Date().toISOString()}}),u.triggerCRMContact({email:r,fullName:l.full_name,companyName:l.company_name,phone:l.phone,leadSource:"techpulse_signup",properties:{role:l.role||"customer",signupDate:new Date().toISOString(),platform:"web"}})])}catch(e){console.error("Webhook automation failed:",e)}return{error:null}}catch(r){let e=r instanceof Error?r.message:"Sign up failed";return t(e),{error:e}}},[t,a]),c=(0,s.useCallback)(async()=>{try{a(!0),t(null);let{error:e}=await n.auth.signOut();if(e)throw e;return r({user:null,profile:null,loading:!1,error:null}),{error:null}}catch(r){let e=r instanceof Error?r.message:"Sign out failed";return t(e),{error:e}}},[t,a]),d=(0,s.useCallback)(async e=>{try{t(null);let{error:r}=await n.auth.resetPasswordForEmail(e.email,{redirectTo:`${window.location.origin}/reset-password`});if(r)throw r;return{error:null}}catch(r){let e=r instanceof Error?r.message:"Password reset failed";return t(e),{error:e}}},[t]),m=(0,s.useCallback)(async e=>{try{if(t(null),e.password!==e.confirmPassword)throw Error("Passwords do not match");let{error:r}=await n.auth.updateUser({password:e.password});if(r)throw r;return{error:null}}catch(r){let e=r instanceof Error?r.message:"Password update failed";return t(e),{error:e}}},[t]),h=(0,s.useCallback)(async s=>{try{if(!e.user)throw Error("No user logged in");a(!0),t(null);let{error:l}=await n.auth.updateUser({data:s});if(l)throw l;let o=await i.update("user_profiles",e.user.id,s);return r(e=>({...e,profile:o,loading:!1})),{error:null,data:o}}catch(r){let e=r instanceof Error?r.message:"Profile update failed";return t(e),{error:e}}},[e.user,t,a]);(0,s.useCallback)(async(e,r)=>{try{return await i.create("user_profiles",{id:e,email:r.email||"",full_name:r.full_name||null,role:r.role||"customer",company_name:r.company_name||null,phone:r.phone||null})}catch(e){return console.error("Error creating user profile:",e),null}},[]);let g=(0,s.useCallback)(r=>{if(!e.profile)return!1;let t={customer:1,technician:2,supervisor:3,admin:4};return t[e.profile.role]>=t[r]},[e.profile]),f=(0,s.useCallback)(r=>!!e.profile&&(({customer:["own_tickets","chat"],technician:["own_tickets","assigned_tickets","chat","knowledge_base"],supervisor:["all_location_tickets","team_management","analytics","chat","knowledge_base"],admin:["all_tickets","user_management","system_settings","analytics","chat","knowledge_base"]})[e.profile.role]?.includes(r)||!1),[e.profile]);return{...e,signIn:l,signUp:o,signOut:c,resetPassword:d,updatePassword:m,updateProfile:h,hasRole:g,canAccess:f,isAuthenticated:!!e.user,isCustomer:e.profile?.role==="customer",isTechnician:e.profile?.role==="technician",isSupervisor:e.profile?.role==="supervisor",isAdmin:e.profile?.role==="admin"}}},8896:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(687),a=t(6189);t(4263);var l=t(3210),o=t(5814),n=t.n(o),i=t(6991),c=t(8248);let u=()=>{let[e,r]=(0,l.useState)(!1),[t,o]=(0,l.useState)(""),{user:u,profile:d,signOut:m}=(0,c.A)(),h=(0,a.useRouter)(),g=(0,l.useCallback)(async()=>{try{await m(),h.push("/login")}catch(e){console.error("Logout error:",e)}},[m,h]),f=(0,l.useCallback)(e=>{e.preventDefault(),t.trim()&&console.log("Search query:",t)},[t]),p=(0,l.useCallback)(e=>{o(e.target.value)},[]),x=(0,l.useCallback)(()=>{r(!1)},[]),y=(0,l.useCallback)(()=>{r(e=>!e)},[]),b=d?.full_name||u?.email||"User",w=d?.full_name?d.full_name.split(" ").map(e=>e[0]).join("").toUpperCase():u?.email?.[0]?.toUpperCase()||"U";return(0,s.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(n(),{href:"/dashboard",className:"flex items-center",children:[(0,s.jsx)("img",{src:"/images/techpulse-logo-light.png",alt:"TechPulse",className:"h-8 w-auto"}),(0,s.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-900",children:"TechPulse"})]})}),(0,s.jsx)("div",{className:"flex-1 max-w-md mx-8",children:(0,s.jsxs)("form",{onSubmit:f,className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search vehicles, tickets, customers...",value:t,onChange:p,className:"w-full px-4 py-2 pl-10 pr-4 text-gray-900 placeholder-gray-500 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(i.In,{icon:"feather:search",className:"h-5 w-5 text-gray-400"})})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[d?.role&&(0,s.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"admin"===d.role?"bg-purple-100 text-purple-800":"supervisor"===d.role?"bg-blue-100 text-blue-800":"technician"===d.role?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:d.role.charAt(0).toUpperCase()+d.role.slice(1)}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:y,className:"flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 hover:bg-gray-50 px-2 py-1 transition-colors","aria-label":"User menu","aria-expanded":e,children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-medium text-sm",children:w}),(0,s.jsx)("span",{className:"ml-2 text-gray-700 font-medium max-w-32 truncate",children:b}),(0,s.jsx)("svg",{className:`ml-1 h-4 w-4 text-gray-400 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:x,"aria-hidden":"true"}),(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:b}),(0,s.jsx)("p",{className:"text-sm text-gray-500 truncate",children:u?.email}),d?.company_name&&(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:d.company_name})]}),(0,s.jsxs)(n(),{href:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",onClick:x,children:[(0,s.jsx)(i.In,{icon:"feather:settings",className:"mr-3 h-4 w-4"}),"Settings"]}),(0,s.jsxs)("button",{onClick:g,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(i.In,{icon:"feather:log-out",className:"mr-3 h-4 w-4"}),"Sign out"]})]})]})]})]})]})})})},d=()=>{let e=(0,a.usePathname)();return(0,s.jsx)("div",{className:"w-64 bg-gray-900 min-h-screen",children:(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)("nav",{className:"space-y-2",children:[{name:"Dashboard",href:"/dashboard",icon:"material-symbols:dashboard"},{name:"AI Chat",href:"/chat",icon:"feather:message-square"},{name:"Analytics",href:"/analytics",icon:"streamline-freehand:analytics-graph-line-triple"},{name:"Users",href:"/users",icon:"feather:users"},{name:"Page Builder",href:"/page-builder",icon:"feather:layout"},{name:"Settings",href:"/settings",icon:"feather:settings"}].map(r=>{let t=e===r.href;return(0,s.jsxs)(n(),{href:r.href,className:`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${t?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[(0,s.jsx)(i.In,{icon:r.icon,className:"mr-3 h-5 w-5"}),r.name]},r.name)})})})})},m=()=>(0,s.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"\xa9 2024 TechPulse Dashboard. All rights reserved."}),(0,s.jsxs)("div",{className:"flex space-x-6",children:[(0,s.jsx)("a",{href:"#",className:"text-sm text-gray-500 hover:text-gray-900",children:"Privacy Policy"}),(0,s.jsx)("a",{href:"#",className:"text-sm text-gray-500 hover:text-gray-900",children:"Terms of Service"}),(0,s.jsx)("a",{href:"#",className:"text-sm text-gray-500 hover:text-gray-900",children:"Support"})]})]})})}),h=["/login","/register","/forgot-password","/reset-password"];function g({children:e}){let r=(0,a.usePathname)(),t=h.includes(r),l="/chat"===r;return t||l?(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:"antialiased",children:e})}):(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:"antialiased",children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(u,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(d,{}),(0,s.jsx)("main",{className:"flex-1 p-6",children:e})]}),(0,s.jsx)(m,{})]})})})}},9727:()=>{}};